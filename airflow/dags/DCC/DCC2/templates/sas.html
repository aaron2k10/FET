{% extends "base.html" %}
{% load static %}

{% block css_files %}
<link rel="stylesheet" href= "{% static 'jobrun.css' %}" >
{% endblock %}

{% block content %}
<body>
<style>
.spinner {
  border: 4px solid rgba(0, 0, 0, 0.1);
  border-left-color: #000;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  animation: spin 1s linear infinite;
  display: none; /* Initially hidden */
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}
</style>
<div class="row">
    <div class="column11">
        <div class="card">
            <h3>Batch in Mainframe <i class="fas fa-running"></i></h3>
            <form method="post" action="{% url 'sas' %}">
                {% csrf_token %}
                <button class="button1" type="submit">
                    Run
                    <span class="spinner" role="status" aria-hidden="true"></span>
                </button>
            </form>
            {% if output_data %}
            <div class="output">
                <h4>Job Results:</h4>
                <div>{{ output_data|safe }}</div> <!-- Display the Excel data as an HTML table -->
            </div>
            {% endif %}
        </div>
    </div>
</div>
<div class="row">
    <div class="column11">
        <div class="card">
            <h3>Batch in Distributed<i class="fas fa-running"></i></h3>
            <form method="post" action="{% url 'sas' %}">
                {% csrf_token %}
                <div style="margin-top: 10px;margin-bottom: 10px;">
                    <select name="scripts" id="scripts" multiple>
                        {% for filename in filenames %}
                        <option value="{{ filename }}">{{ filename }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button class="button1" type="submit">
                    Run
                    <span class="spinner" role="status" aria-hidden="true"></span>
                </button>
            </form>
            {% if python_data %}
        <div class="success-message" style="margin-top: 10px;">
            <h4>Script Results:</h4>
            <div>{{ python_data|safe }}</div>
        </div>
        {% endif %}
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('button[type="submit"]').forEach(function(button) {
            button.addEventListener('click', function() {
                this.querySelector('.spinner').style.display = 'inline-block';
                this.childNodes[0].textContent = 'Execution in-progress';
            });
        });
    });
</script>
</body>
{% endblock %}

{% block js_files %}
<script src="{% static 'js/script.js' %}"></script>
{% endblock %}
